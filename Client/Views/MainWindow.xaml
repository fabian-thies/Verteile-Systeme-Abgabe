<Window x:Class="Client.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:Client.Views"
        Title="Chat Application" Height="600" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource WindowBackgroundBrush}"
        FontFamily="Segoe UI"
        WindowStyle="None"
        AllowsTransparency="True">
  <Border Background="White" CornerRadius="8" Padding="0" Effect="{DynamicResource DropShadowEffect}">
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="40"/> <!-- Custom title bar -->
        <RowDefinition Height="*"/>  <!-- Content area -->
      </Grid.RowDefinitions>
      <!-- Custom Title Bar -->
      <DockPanel Grid.Row="0" Background="{StaticResource PrimaryBrush}" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
          <TextBlock Text="Chat Application" Foreground="White" VerticalAlignment="Center" Margin="10,0,0,0" FontWeight="Bold" FontSize="16"/>
          <Button Content="X" Width="40" Height="40" DockPanel.Dock="Right" 
                  Click="CloseButton_Click"
                  Background="Transparent" BorderBrush="Transparent" 
                  Foreground="White" FontWeight="Bold"/>
      </DockPanel>
      <!-- Content Area -->
      <Grid Grid.Row="1">
        <TabControl Name="ChatTabControl" Margin="10">
          <TabItem Header="Private Chat">
            <Grid Margin="10">
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
              </Grid.RowDefinitions>
              <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,10">
                <TextBlock Text="To (Username):" VerticalAlignment="Center"/>
                <TextBox Name="PrivateTargetTextBox" Width="200" Margin="10,0"/>
              </StackPanel>
              <ListBox Name="PrivateChatListBox" Grid.Row="1" ItemContainerStyle="{StaticResource ChatMessageStyle}">
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <!-- Chat bubble style for messages (unverändert, falls gewünscht) -->
                    <Border Background="{StaticResource ChatBubbleBackground}" 
                            CornerRadius="8" Padding="8" Margin="4">
                      <TextBlock Text="{Binding}" TextWrapping="Wrap"/>
                    </Border>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
              <StackPanel Orientation="Horizontal" Grid.Row="2" Margin="0,10,0,0">
                <TextBox Name="PrivateMessageTextBox" Width="500" KeyDown="PrivateMessageTextBox_KeyDown"/>
                <Button Content="Send" Click="SendPrivateMessageButton_Click" Margin="10,0"/>
                <Button Content="Whiteboard" Click="OpenPrivateWhiteboardButton_Click" Margin="10,0"/>
              </StackPanel>
            </Grid>
          </TabItem>
          <TabItem Header="Group Chat">
            <Grid Margin="10">
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
              </Grid.RowDefinitions>
              <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,10">
                <TextBlock Text="Group Name:" VerticalAlignment="Center"/>
                <TextBox Name="GroupNameTextBox" Width="200" Margin="10,0"/>
                <Button Content="Join Group" Click="JoinGroupButton_Click" Margin="10,0"/>
                <Button Content="Leave Group" Click="LeaveGroupButton_Click" Margin="10,0"/>
              </StackPanel>
              <ListBox Name="GroupChatListBox" Grid.Row="1" ItemContainerStyle="{StaticResource ChatMessageStyle}">
                <ListBox.ItemTemplate>
                  <DataTemplate>
                    <Border Background="{StaticResource ChatBubbleBackground}" 
                            CornerRadius="8" Padding="8" Margin="4">
                      <TextBlock Text="{Binding}" TextWrapping="Wrap"/>
                    </Border>
                  </DataTemplate>
                </ListBox.ItemTemplate>
              </ListBox>
              <StackPanel Orientation="Horizontal" Grid.Row="2" Margin="0,10,0,0">
                <TextBox Name="GroupMessageTextBox" Width="500" KeyDown="GroupMessageTextBox_KeyDown"/>
                <Button Content="Send" Click="SendGroupMessageButton_Click" Margin="10,0"/>
                <Button Content="Whiteboard" Click="OpenGroupWhiteboardButton_Click" Margin="10,0"/>
              </StackPanel>
            </Grid>
          </TabItem>
          <TabItem Header="Plugins">
            <!-- Plugin Manager bleibt unverändert -->
            <views:PluginManager/>
          </TabItem>
        </TabControl>
      </Grid>
    </Grid>
  </Border>
</Window>
